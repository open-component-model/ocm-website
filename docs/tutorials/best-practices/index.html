<!doctype html><html lang=en data-bs-theme=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=https://ocm.software/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://ocm.software/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://ocm.software/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg="></script><link rel=stylesheet href="/main.9e91d603cb6ae4b2951ad48b5f65ef76c30a0f92059b22a2a60e21d03af8da9b75bcfe1a0ba2d65eb1d4d061b4fd43173931b81fc9cbf4f74538052dad260e24.css" integrity="sha512-npHWA8tq5LKVGtSLX2XvdsMKD5IFmyKipg4h0Dr42pt1vP4aC6LWXrHU0GG0/UMXOTG4H8nL9PdFOAUtrSYOJA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><base href=https://ocm.software/docs/tutorials/best-practices/><link rel=canonical href=https://ocm.software/docs/tutorials/best-practices/><title>Best Practices | Open Component Model</title>
<meta name=description content><link rel=icon href=/favicon.ico sizes=32x32><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180 type=image/png><link rel=icon href=/favicon-192x192.png sizes=192x192 type=image/png><link rel=icon href=/favicon-512x512.png sizes=512x512 type=image/png><link rel=manifest href=/manifest.webmanifest><meta property="og:url" content="https://ocm.software/docs/tutorials/best-practices/"><meta property="og:site_name" content="Open Component Model"><meta property="og:title" content="Best Practices"><meta property="og:description" content="This chapter contains guidelines for common scenarios how to work with the Open Component Model, focusing on using CI/CD, build and publishing processes."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta name=twitter:card content="summary"><meta name=twitter:title content="Best Practices"><meta name=twitter:description content="This chapter contains guidelines for common scenarios how to work with the Open Component Model, focusing on using CI/CD, build and publishing processes."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://ocm.software/","name":"Open Component Model","position":1},{"@type":"ListItem","item":"https://ocm.software/docs/","name":"Docs","position":2},{"@type":"ListItem","item":"https://ocm.software/docs/tutorials/","name":"Tutorials","position":3},{"@type":"ListItem","name":"Best Practices","position":4}]}</script></head><body class="single section docs" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg"><div class=container-fluid><a class="navbar-brand order-0 ocm-logo d-flex align-items-center" href=/ aria-label><span class="ocm-logo-icon d-flex align-items-center" style=height:64px><svg id="Layer_1" viewBox="0 0 145.39999 145.4" sodipodi:docname="ocm-logo-icon-colour.svg" width="145.39999" height="145.39999" inkscape:version="1.4.2 (ebf0e940, 2025-05-08)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:svg="http://www.w3.org/2000/svg"><sodipodi:namedview id="namedview6" pagecolor="#ffffff" bordercolor="#000000" borderopacity=".25" inkscape:showpageshadow="2" inkscape:pageopacity="0" inkscape:pagecheckerboard="0" inkscape:deskcolor="#d1d1d1" inkscape:zoom="1.369322" inkscape:cx="57.692786" inkscape:cy="101.14495" inkscape:window-width="1024" inkscape:window-height="604" inkscape:window-x="415" inkscape:window-y="256" inkscape:window-maximized="0" inkscape:current-layer="Layer_1"/><defs id="defs2"><style id="style1">.st0{fill:#fff}.st0,.st1,.st2{fill-rule:evenodd}.st1{fill:url(#linear-gradient)}.st2{fill:#407bd4}</style><linearGradient id="linear-gradient" x1="3348.8" y1="2398.7" x2="3348.8999" y2="2398.7" gradientTransform="matrix(338.02935,313.01861,313.01861,-338.02935,-1882854.2,-236563.3)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#2e5b9d" id="stop1"/><stop offset="1" stop-color="#3b72c7" id="stop2"/></linearGradient></defs><path class="st2" d="M98.2 3.6C93.7 2 89.1.7 84.4.0l-4.6 5.1c-5-.5-10-.5-14.9.0l-4.7-5c-4.7.8-9.3 2.1-13.7 3.8L45 10.6c-4.6 2-8.9 4.6-12.9 7.5l-6.5-2c-3.7 3-7 6.4-10 10.1l2.1 6.5c-2.9 4-5.4 8.4-7.4 13L3.6 47.2C2 51.7.7 56.3.0 61l5.1 4.6c-.5 5-.5 10 0 14.9l-5 4.7c.8 4.7 2.1 9.3 3.8 13.7l6.7 1.5c2 4.6 4.6 8.9 7.5 12.9l-2 6.5c3 3.7 6.4 7 10.1 10l6.5-2.1c4 2.9 8.4 5.4 13 7.4l1.5 6.7c4.5 1.6 9.1 2.9 13.8 3.6l4.6-5.1c5 .5 10 .5 14.9.0l4.7 5c4.7-.8 9.3-2.1 13.7-3.8l1.5-6.7c4.6-2 8.9-4.6 12.9-7.5l6.5 2c3.7-3 7-6.4 10-10.1l-2.1-6.5c2.9-4 5.4-8.4 7.4-13l6.7-1.5c1.6-4.5 2.9-9.1 3.6-13.8l-5.1-4.6c.5-5 .5-10 0-14.9l5-4.7c-.8-4.7-2.1-9.3-3.8-13.7L134.8 45c-2-4.6-4.6-8.9-7.5-12.9l2-6.5c-3-3.7-6.4-7-10.1-10l-6.5 2.1c-4-2.9-8.4-5.4-13-7.4z" id="path2"/><path class="st1" d="M68.7 140.7 29.9 103.5l35.2-27-13.2-12L94.2 41.7 143.8 92c-.6 2.1-1.2 4.2-2 6.2l-6.7 1.5c-2 4.6-4.5 8.9-7.4 13l2.1 6.5c-3 3.7-6.4 7.1-10 10.1l-6.5-2c-4 3-8.3 5.5-12.9 7.5l-1.5 6.7c-4.4 1.7-9 3-13.7 3.8l-4.7-5c-4 .5-8 .6-11.9.3z" id="path3" style="fill:url(#linear-gradient)"/><path class="st0" d="m64.9 74.9c0 .1.1.2.2.3 1.1.6 6.9 4 6.9 4v7.4s0 .1.0.2v.3c-.6 1-1.7 1.5-2.7 1.2L68 88c-1.1-.3-2.2.0-3.1.6-.9.7-1.4 1.7-1.4 2.9v0c0 1.1.5 2.2 1.4 2.9s2 .9 3.1.6l1.4-.4c1-.3 2 .2 2.4 1.1l.2.4s0 .1.0.2v7.4L50.9 115.9 29.8 103.7V79.4L50.9 67.2s6.6 3.8 7.7 4.4c0 0 .2.0.3.0.8-.2 1.4-.5 2-.9 1.1-.6 1.9-1.6 1.9-2.8.0-.7.3-1.3.9-1.6.6-.4 1.2-.5 1.9-.3.3.1.6.3.8.5.5.4.8 1.2.7 1.9s-.4 1.2-1 1.5c-1.1.6-1.6 1.8-1.6 3 0 .7.0 1.5.3 2.2z" id="path4"/><path class="st0" d="m80.4 74.1c-.1.0-.2.0-.3.0-1.1.6-6.9 4-6.9 4l-6.4-3.7-.1-.1L66.5 74.1C65.9 73.2 66 72 66.7 71.2l.9-.9c.8-.8 1.2-1.9 1-3-.1-1.1-.8-2.1-1.8-2.6v0c-1-.6-2.1-.6-3.2-.2-1 .4-1.8 1.3-2.1 2.4l-.4 1.4c-.3 1-1.2 1.6-2.2 1.5h-.4s-.2.0-.2-.1L51.9 66V41.7L73 29.5 94.1 41.7V66s-6.6 3.8-7.7 4.4c0 0-.2.2-.2.3-.2.8-.3 1.5-.2 2.2.2 1.2.5 2.5 1.5 3.1.6.3.9.9 1 1.6.0.7-.1 1.3-.6 1.8-.3.2-.5.4-.9.5-.6.2-1.4.0-2-.3s-.8-1-.8-1.6c0-1.2-.8-2.3-1.8-2.9-.6-.3-1.3-.7-2.1-.9z" id="path5"/><path class="st0" d="m73.3 87.9s.1-.2.1-.3c0-1.2.0-8 0-8l6.4-3.7s.1.0.2.0h.3c1.1-.1 2.1.6 2.4 1.6l.3 1.3c.3 1.1 1.1 2 2.1 2.4s2.2.3 3.2-.2v0c1-.6 1.6-1.5 1.8-2.6.1-1.1-.2-2.2-1-3l-1-1c-.7-.7-.8-1.8-.2-2.7l.2-.3s.1-.1.2-.2l6.4-3.7 21.1 12.1v24.3l-21 12.2L73.7 104s0-7.6.0-8.9c0-.1.0-.2-.1-.3-.5-.6-1-1.1-1.6-1.4-.7-.4-2.5-.7-3.6.0-.6.3-1.3.3-1.9.0-.6-.3-1.1-.8-1.2-1.4.0-.3.0-.7.0-1 .1-.6.7-1.3 1.3-1.5s1.3-.3 1.8.0c1.1.6 2.4.5 3.4-.1C72.4 89 73 88.6 73.6 88z" id="path6"/></svg>
</span><span class="ocm-logo-text d-flex align-items-center" style=height:64px;margin-left:-.2rem><svg viewBox="0 0 2979 967.18" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style>text,tspan{font-family:quicksand,sans-serif}</style><clipPath id="clipPath1"><path transform="matrix(1 0 0 -1 -68.258 541.86)" d="m0 0h2234.2v725.38H0z" clip-rule="evenodd"/></clipPath><clipPath id="clipPath2"><path transform="matrix(1 0 0 -1 -61.526 254)" d="m0 0h2234.2v725.38H0z" clip-rule="evenodd"/></clipPath><clipPath id="clipPath3"><path transform="matrix(1.0022 0 0 -.99781 -1572.6 68.795)" d="m0 0h2234.2v725.38H0z" clip-rule="evenodd"/></clipPath></defs><g fill="currentcolor"><text transform="matrix(1.3333 0 0 1.3333 91.011 244.7)" clip-path="url(#clipPath1)"><tspan x="0" y="0" dx="0 3.6024599 3.6024599 3.6024599" fill="currentcolor" font-family="Quicksand" font-size="180.12" font-weight="200">OPEN</tspan></text><text transform="matrix(1.3333 0 0 1.3333 82.035 628.52)" clip-path="url(#clipPath2)"><tspan x="0" y="0" dx="0 6.8541799 6.8541799 6.8541799 6.8541799 6.8541799 6.8541799 6.8541799 6.8541799" fill="currentcolor" font-family="Quicksand" font-size="342.71" font-weight="200">COMPONENT</tspan></text><text transform="matrix(1.3304 0 0 1.3363 2092.2 875.25)" clip-path="url(#clipPath3)"><tspan x="0" y="0" dx="0 3.9049001 3.9049001 3.9049001 3.9049001" fill="currentcolor" font-family="Quicksand" font-size="195.24" font-weight="200">MODEL</tspan></text></g></svg>
</span></a><button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
<svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
</button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Docs</h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><nav class="section-nav docs-links"><ul class=list-unstyled><li><details><summary>Overview</summary><ul class="list-unstyled list-nested"><li><a href=/docs/overview/about/>About the OCM Project</a></li><li><a href=/docs/overview/benefits-of-ocm/>Benefits of OCM</a></li><li><a href=/docs/overview/important-terms/>Important Terms</a></li><li><a href=/docs/overview/specification/>Specification</a></li></ul></details></li><li><details><summary>Getting Started</summary><ul class="list-unstyled list-nested"><li><a href=/docs/getting-started/prerequisites/>Prerequisites</a></li><li><a href=/docs/getting-started/installation/>Installing the OCM CLI</a></li><li><a href=/docs/getting-started/create-component-version/>Create a Component Version</a></li><li><a href=/docs/getting-started/display-and-examine-component-versions/>Display and Examine Component Versions</a></li><li><a href=/docs/getting-started/sign-component-versions/>Sign Component Versions</a></li><li><a href=/docs/getting-started/transport-ocm-component-versions/>Transport OCM Component Versions</a></li><li><a href=/docs/getting-started/component-descriptor-example/>Example of a component descriptor</a></li><li><a href=/docs/getting-started/installing-the-ocm-controller/>Installing the OCM Controller</a></li></ul></details></li><li><details open><summary>Tutorials</summary><ul class="list-unstyled list-nested"><li class=active><a aria-current=page href=/docs/tutorials/best-practices/>Best Practices</a></li><li><a href=/docs/tutorials/build-deploy-applications-using-helm-charts-and-ocm/>Build & Deploy Applications using Helm Charts and OCM</a></li><li><a href=/docs/tutorials/structuring-software-products-with-ocm/>Structuring Software Products with OCM</a></li><li><a href=/docs/tutorials/creds-in-ocmconfig/>Credentials in .ocmconfig file</a></li><li><a href=/docs/tutorials/input-and-access-types/>Input and Access Types</a></li><li><details><summary>OCM and GitOps</summary><ul class="list-unstyled list-nested"><li><a href=/docs/tutorials/ocm-and-gitops/deploying-applications-with-ocm-gitops/>Deploying Applications with OCM & GitOps</a></li><li><a href=/docs/tutorials/ocm-and-gitops/air-gapped-gitops-with-ocm-flux/>Air-gapped GitOps with OCM & Flux</a></li><li><a href=/docs/tutorials/ocm-and-gitops/gitops-driven-configuration-of-ocm-applications/>GitOps Driven Configuration of OCM Applications</a></li><li><a href=/docs/tutorials/ocm-and-gitops/secure-software-delivery-with-flux-and-ocm/>Secure software delivery with Flux and OCM</a></li></ul></details></li></ul></details></li><li><details><summary>Reference</summary><ul class="list-unstyled list-nested"><li><details><summary>OCM Controller</summary><ul class="list-unstyled list-nested"><li><details><summary>API</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-controller/api/ocm-controller-api/>OCM Controller API</a></li></ul></details></li><li><details><summary>CRDs</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-controller/crds/component-version/>Component Version</a></li></ul></details></li><li><a href=/docs/reference/ocm-controller/architecture/>Architecture</a></li></ul></details></li><li><details><summary>OCM CLI</summary><ul class="list-unstyled list-nested"><li><details><summary>add</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/add/componentversions/>componentversions</a></li><li><a href=/docs/reference/ocm-cli/add/references/>references</a></li><li><a href=/docs/reference/ocm-cli/add/resource-configuration/>resource-configuration</a></li><li><a href=/docs/reference/ocm-cli/add/resources/>resources</a></li><li><a href=/docs/reference/ocm-cli/add/routingslips/>routingslips</a></li><li><a href=/docs/reference/ocm-cli/add/source-configuration/>source-configuration</a></li><li><a href=/docs/reference/ocm-cli/add/sources/>sources</a></li></ul></details></li><li><details><summary>check</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/check/componentversions/>componentversions</a></li></ul></details></li><li><details><summary>clean</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/clean/cache/>cache</a></li></ul></details></li><li><details><summary>create</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/create/componentarchive/>componentarchive</a></li><li><a href=/docs/reference/ocm-cli/create/rsakeypair/>rsakeypair</a></li><li><a href=/docs/reference/ocm-cli/create/transportarchive/>transportarchive</a></li></ul></details></li><li><details><summary>describe</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/describe/artifacts/>artifacts</a></li><li><a href=/docs/reference/ocm-cli/describe/cache/>cache</a></li><li><a href=/docs/reference/ocm-cli/describe/package/>package</a></li><li><a href=/docs/reference/ocm-cli/describe/plugins/>plugins</a></li></ul></details></li><li><details><summary>download</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/download/artifacts/>artifacts</a></li><li><a href=/docs/reference/ocm-cli/download/cli/>cli</a></li><li><a href=/docs/reference/ocm-cli/download/componentversions/>componentversions</a></li><li><a href=/docs/reference/ocm-cli/download/resources/>resources</a></li></ul></details></li><li><details><summary>get</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/get/artifacts/>artifacts</a></li><li><a href=/docs/reference/ocm-cli/get/componentversions/>componentversions</a></li><li><a href=/docs/reference/ocm-cli/get/config/>config</a></li><li><a href=/docs/reference/ocm-cli/get/credentials/>credentials</a></li><li><a href=/docs/reference/ocm-cli/get/plugins/>plugins</a></li><li><a href=/docs/reference/ocm-cli/get/pubsub/>pubsub</a></li><li><a href=/docs/reference/ocm-cli/get/references/>references</a></li><li><a href=/docs/reference/ocm-cli/get/resources/>resources</a></li><li><a href=/docs/reference/ocm-cli/get/routingslips/>routingslips</a></li><li><a href=/docs/reference/ocm-cli/get/sources/>sources</a></li><li><a href=/docs/reference/ocm-cli/get/verified/>verified</a></li></ul></details></li><li><details><summary>help</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/help/attributes/>attributes</a></li><li><a href=/docs/reference/ocm-cli/help/configfile/>configfile</a></li><li><a href=/docs/reference/ocm-cli/help/credential-handling/>credential-handling</a></li><li><a href=/docs/reference/ocm-cli/help/logging/>logging</a></li><li><a href=/docs/reference/ocm-cli/help/oci-references/>oci-references</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-accessmethods/>ocm-accessmethods</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-downloadhandlers/>ocm-downloadhandlers</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-labels/>ocm-labels</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-pubsub/>ocm-pubsub</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-references/>ocm-references</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-uploadhandlers/>ocm-uploadhandlers</a></li><li><a href=/docs/reference/ocm-cli/help/toi-bootstrapping/>toi-bootstrapping</a></li></ul></details></li><li><details><summary>list</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/list/componentversions/>componentversions</a></li></ul></details></li><li><details><summary>set</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/set/pubsub/>pubsub</a></li></ul></details></li><li><details><summary>show</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/show/tags/>tags</a></li><li><a href=/docs/reference/ocm-cli/show/versions/>versions</a></li></ul></details></li><li><details><summary>sign</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/sign/componentversions/>componentversions</a></li><li><a href=/docs/reference/ocm-cli/sign/hash/>hash</a></li></ul></details></li><li><details><summary>transfer</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/transfer/artifacts/>artifacts</a></li><li><a href=/docs/reference/ocm-cli/transfer/commontransportarchive/>commontransportarchive</a></li><li><a href=/docs/reference/ocm-cli/transfer/componentarchive/>componentarchive</a></li><li><a href=/docs/reference/ocm-cli/transfer/componentversions/>componentversions</a></li></ul></details></li><li><details><summary>verify</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/verify/componentversions/>componentversions</a></li></ul></details></li></ul></details></li></ul></details></li></ul></nav></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class="header-bar d-lg-none"></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>Open Component Model</h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class="nav-link active" href=https://ocm.software/docs/overview/about aria-current=true>Docs</a></li><li class=nav-item><a class=nav-link href=https://ocm.software/community/engagement>Community</a></li><li class=nav-item><a class=nav-link href=https://github.com/orgs/open-component-model/projects/10/views/5>Roadmap</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block order-lg-3" aria-label="Search website"><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button><div class="dropdown mt-1 order-lg-1"><button class="btn btn-dropdown dropdown-toggle" id=doks-versions data-bs-toggle=dropdown aria-expanded=false data-bs-display=static aria-label="Toggle version menu">
Versions
<span class=dropdown-caret><svg class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6 6-6"/></svg></span></button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=doks-versions><li><a class="dropdown-item current" aria-current=true href=/docs/overview/about>current (latest)</a></li></ul></div><button id=buttonColorMode class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1 order-lg-4" type=button aria-label="Toggle theme"><svg data-bs-theme-value="dark" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/></svg><svg data-bs-theme-value="light" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://github.com/open-component-model><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://kubernetes.slack.com/archives/C05UWBE8R1D><svg role="img" width="22" height="22" viewBox="0 0 24 24" fill="#fff"><path d="M5.042 15.165a2.528 2.528.0 01-2.52 2.523A2.528 2.528.0 010 15.165a2.527 2.527.0 012.522-2.52h2.52v2.52zm1.271.0a2.527 2.527.0 012.521-2.52 2.527 2.527.0 012.521 2.52v6.313A2.528 2.528.0 018.834 24a2.528 2.528.0 01-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528.0 01-2.521-2.52A2.528 2.528.0 018.834.0a2.528 2.528.0 012.521 2.522v2.52H8.834zm0 1.271a2.528 2.528.0 012.521 2.521 2.528 2.528.0 01-2.521 2.521H2.522A2.528 2.528.0 010 8.834a2.528 2.528.0 012.522-2.521h6.312zM18.956 8.834a2.528 2.528.0 012.522-2.521A2.528 2.528.0 0124 8.834a2.528 2.528.0 01-2.522 2.521h-2.522V8.834zm-1.268.0a2.528 2.528.0 01-2.523 2.521 2.527 2.527.0 01-2.52-2.521V2.522A2.527 2.527.0 0115.165.0a2.528 2.528.0 012.523 2.522v6.312zM15.165 18.956a2.528 2.528.0 012.523 2.522A2.528 2.528.0 0115.165 24a2.527 2.527.0 01-2.52-2.522v-2.522h2.52zm0-1.268a2.527 2.527.0 01-2.52-2.523 2.526 2.526.0 012.52-2.52h6.313A2.527 2.527.0 0124 15.165a2.528 2.528.0 01-2.522 2.523h-6.313z"/></svg><small class="ms-2 visually-hidden">Slack</small></a></li></ul></div></div></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=UTF-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class="submitted d-none"><time class=created-date>Date here</time></div></header><div class=content>Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-fluid" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar docs-sidebar-offset d-none d-lg-block"><nav class="section-nav docs-links"><ul class=list-unstyled><li><details><summary>Overview</summary><ul class="list-unstyled list-nested"><li><a href=/docs/overview/about/>About the OCM Project</a></li><li><a href=/docs/overview/benefits-of-ocm/>Benefits of OCM</a></li><li><a href=/docs/overview/important-terms/>Important Terms</a></li><li><a href=/docs/overview/specification/>Specification</a></li></ul></details></li><li><details><summary>Getting Started</summary><ul class="list-unstyled list-nested"><li><a href=/docs/getting-started/prerequisites/>Prerequisites</a></li><li><a href=/docs/getting-started/installation/>Installing the OCM CLI</a></li><li><a href=/docs/getting-started/create-component-version/>Create a Component Version</a></li><li><a href=/docs/getting-started/display-and-examine-component-versions/>Display and Examine Component Versions</a></li><li><a href=/docs/getting-started/sign-component-versions/>Sign Component Versions</a></li><li><a href=/docs/getting-started/transport-ocm-component-versions/>Transport OCM Component Versions</a></li><li><a href=/docs/getting-started/component-descriptor-example/>Example of a component descriptor</a></li><li><a href=/docs/getting-started/installing-the-ocm-controller/>Installing the OCM Controller</a></li></ul></details></li><li><details open><summary>Tutorials</summary><ul class="list-unstyled list-nested"><li class=active><a aria-current=page href=/docs/tutorials/best-practices/>Best Practices</a></li><li><a href=/docs/tutorials/build-deploy-applications-using-helm-charts-and-ocm/>Build & Deploy Applications using Helm Charts and OCM</a></li><li><a href=/docs/tutorials/structuring-software-products-with-ocm/>Structuring Software Products with OCM</a></li><li><a href=/docs/tutorials/creds-in-ocmconfig/>Credentials in .ocmconfig file</a></li><li><a href=/docs/tutorials/input-and-access-types/>Input and Access Types</a></li><li><details><summary>OCM and GitOps</summary><ul class="list-unstyled list-nested"><li><a href=/docs/tutorials/ocm-and-gitops/deploying-applications-with-ocm-gitops/>Deploying Applications with OCM & GitOps</a></li><li><a href=/docs/tutorials/ocm-and-gitops/air-gapped-gitops-with-ocm-flux/>Air-gapped GitOps with OCM & Flux</a></li><li><a href=/docs/tutorials/ocm-and-gitops/gitops-driven-configuration-of-ocm-applications/>GitOps Driven Configuration of OCM Applications</a></li><li><a href=/docs/tutorials/ocm-and-gitops/secure-software-delivery-with-flux-and-ocm/>Secure software delivery with Flux and OCM</a></li></ul></details></li></ul></details></li><li><details><summary>Reference</summary><ul class="list-unstyled list-nested"><li><details><summary>OCM Controller</summary><ul class="list-unstyled list-nested"><li><details><summary>API</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-controller/api/ocm-controller-api/>OCM Controller API</a></li></ul></details></li><li><details><summary>CRDs</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-controller/crds/component-version/>Component Version</a></li></ul></details></li><li><a href=/docs/reference/ocm-controller/architecture/>Architecture</a></li></ul></details></li><li><details><summary>OCM CLI</summary><ul class="list-unstyled list-nested"><li><details><summary>add</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/add/componentversions/>componentversions</a></li><li><a href=/docs/reference/ocm-cli/add/references/>references</a></li><li><a href=/docs/reference/ocm-cli/add/resource-configuration/>resource-configuration</a></li><li><a href=/docs/reference/ocm-cli/add/resources/>resources</a></li><li><a href=/docs/reference/ocm-cli/add/routingslips/>routingslips</a></li><li><a href=/docs/reference/ocm-cli/add/source-configuration/>source-configuration</a></li><li><a href=/docs/reference/ocm-cli/add/sources/>sources</a></li></ul></details></li><li><details><summary>check</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/check/componentversions/>componentversions</a></li></ul></details></li><li><details><summary>clean</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/clean/cache/>cache</a></li></ul></details></li><li><details><summary>create</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/create/componentarchive/>componentarchive</a></li><li><a href=/docs/reference/ocm-cli/create/rsakeypair/>rsakeypair</a></li><li><a href=/docs/reference/ocm-cli/create/transportarchive/>transportarchive</a></li></ul></details></li><li><details><summary>describe</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/describe/artifacts/>artifacts</a></li><li><a href=/docs/reference/ocm-cli/describe/cache/>cache</a></li><li><a href=/docs/reference/ocm-cli/describe/package/>package</a></li><li><a href=/docs/reference/ocm-cli/describe/plugins/>plugins</a></li></ul></details></li><li><details><summary>download</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/download/artifacts/>artifacts</a></li><li><a href=/docs/reference/ocm-cli/download/cli/>cli</a></li><li><a href=/docs/reference/ocm-cli/download/componentversions/>componentversions</a></li><li><a href=/docs/reference/ocm-cli/download/resources/>resources</a></li></ul></details></li><li><details><summary>get</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/get/artifacts/>artifacts</a></li><li><a href=/docs/reference/ocm-cli/get/componentversions/>componentversions</a></li><li><a href=/docs/reference/ocm-cli/get/config/>config</a></li><li><a href=/docs/reference/ocm-cli/get/credentials/>credentials</a></li><li><a href=/docs/reference/ocm-cli/get/plugins/>plugins</a></li><li><a href=/docs/reference/ocm-cli/get/pubsub/>pubsub</a></li><li><a href=/docs/reference/ocm-cli/get/references/>references</a></li><li><a href=/docs/reference/ocm-cli/get/resources/>resources</a></li><li><a href=/docs/reference/ocm-cli/get/routingslips/>routingslips</a></li><li><a href=/docs/reference/ocm-cli/get/sources/>sources</a></li><li><a href=/docs/reference/ocm-cli/get/verified/>verified</a></li></ul></details></li><li><details><summary>help</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/help/attributes/>attributes</a></li><li><a href=/docs/reference/ocm-cli/help/configfile/>configfile</a></li><li><a href=/docs/reference/ocm-cli/help/credential-handling/>credential-handling</a></li><li><a href=/docs/reference/ocm-cli/help/logging/>logging</a></li><li><a href=/docs/reference/ocm-cli/help/oci-references/>oci-references</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-accessmethods/>ocm-accessmethods</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-downloadhandlers/>ocm-downloadhandlers</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-labels/>ocm-labels</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-pubsub/>ocm-pubsub</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-references/>ocm-references</a></li><li><a href=/docs/reference/ocm-cli/help/ocm-uploadhandlers/>ocm-uploadhandlers</a></li><li><a href=/docs/reference/ocm-cli/help/toi-bootstrapping/>toi-bootstrapping</a></li></ul></details></li><li><details><summary>list</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/list/componentversions/>componentversions</a></li></ul></details></li><li><details><summary>set</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/set/pubsub/>pubsub</a></li></ul></details></li><li><details><summary>show</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/show/tags/>tags</a></li><li><a href=/docs/reference/ocm-cli/show/versions/>versions</a></li></ul></details></li><li><details><summary>sign</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/sign/componentversions/>componentversions</a></li><li><a href=/docs/reference/ocm-cli/sign/hash/>hash</a></li></ul></details></li><li><details><summary>transfer</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/transfer/artifacts/>artifacts</a></li><li><a href=/docs/reference/ocm-cli/transfer/commontransportarchive/>commontransportarchive</a></li><li><a href=/docs/reference/ocm-cli/transfer/componentarchive/>componentarchive</a></li><li><a href=/docs/reference/ocm-cli/transfer/componentversions/>componentversions</a></li></ul></details></li><li><details><summary>verify</summary><ul class="list-unstyled list-nested"><li><a href=/docs/reference/ocm-cli/verify/componentversions/>componentversions</a></li></ul></details></li></ul></details></li></ul></details></li></ul></nav></div><div class="col container-fw d-lg-flex flex-lg-row justify-content-center mx-auto"><nav class="docs-toc docs-toc-offset d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=toc><ul><li><a href=#use-public-schema-for-validation-and-auto-completion-of-component-descriptors>Use Public Schema for Validation and Auto-Completion of Component Descriptors</a></li><li><a href=#separate-build-and-publish-processes>Separate Build and Publish Processes</a></li><li><a href=#using-makefiles>Using Makefiles</a><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#example-makefile>Example Makefile</a></li><li><a href=#templating-the-resources>Templating the Resources</a></li></ul></li><li><a href=#pipeline-integration>Pipeline Integration</a></li><li><a href=#static-and-dynamic-variable-substitution>Static and Dynamic Variable Substitution</a><ul><li><a href=#example-substitution-file>Example Substitution File</a></li></ul></li><li><a href=#debugging-explain-the-blobs-directory>Debugging: Explain the Blobs Directory</a></li><li><a href=#self-contained-transport-archives>Self-Contained Transport Archives</a></li><li><a href=#cicd-integration>CICD Integration</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Best Practices</h1><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><a href=#use-public-schema-for-validation-and-auto-completion-of-component-descriptors>Use Public Schema for Validation and Auto-Completion of Component Descriptors</a></li><li><a href=#separate-build-and-publish-processes>Separate Build and Publish Processes</a></li><li><a href=#using-makefiles>Using Makefiles</a><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#example-makefile>Example Makefile</a></li><li><a href=#templating-the-resources>Templating the Resources</a></li></ul></li><li><a href=#pipeline-integration>Pipeline Integration</a></li><li><a href=#static-and-dynamic-variable-substitution>Static and Dynamic Variable Substitution</a><ul><li><a href=#example-substitution-file>Example Substitution File</a></li></ul></li><li><a href=#debugging-explain-the-blobs-directory>Debugging: Explain the Blobs Directory</a></li><li><a href=#self-contained-transport-archives>Self-Contained Transport Archives</a></li><li><a href=#cicd-integration>CICD Integration</a></li></ul></nav></div></details></nav><p>This chapter contains guidelines for common scenarios how to work with the Open Component Model, focusing on using CI/CD, build and publishing processes.</p><ul><li><a href=#use-public-schema-for-validation-and-auto-completion-of-component-descriptors>Use Public Schema for Validation and Auto-Completion of Component Descriptors</a></li><li><a href=#separate-build-and-publish-processes>Separate Build and Publish Processes</a></li><li><a href=#using-makefiles>Using Makefiles</a><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#example-makefile>Example Makefile</a></li><li><a href=#templating-the-resources>Templating the Resources</a></li></ul></li><li><a href=#pipeline-integration>Pipeline Integration</a></li><li><a href=#static-and-dynamic-variable-substitution>Static and Dynamic Variable Substitution</a><ul><li><a href=#example-substitution-file>Example Substitution File</a></li></ul></li><li><a href=#debugging-explain-the-blobs-directory>Debugging: Explain the Blobs Directory</a></li><li><a href=#self-contained-transport-archives>Self-Contained Transport Archives</a></li><li><a href=#cicd-integration>CICD Integration</a></li></ul><h2 id=use-public-schema-for-validation-and-auto-completion-of-component-descriptors>Use Public Schema for Validation and Auto-Completion of Component Descriptors<a href=#use-public-schema-for-validation-and-auto-completion-of-component-descriptors class=anchor aria-hidden=true>#</a></h2><p>The Open Component Model (OCM) provides a public schema to validate and offer auto-completion of component constructor files
used to create component descriptors.
This schema is available at
<a href=https://ocm.software/schemas/configuration-schema.yaml target=_blank rel=noopener>https://ocm.software/schemas/configuration-schema.yaml</a>.</p><p>To use this schema in your IDE, you can add the following line to your component constructor file:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># yaml-language-server: $schema=https://ocm.software/schemas/configuration-schema.yaml</span></span></span></code></pre></div></figure></div><p>This line tells the YAML language server to use the OCM schema for validation and auto-completion.</p><h2 id=separate-build-and-publish-processes>Separate Build and Publish Processes<a href=#separate-build-and-publish-processes class=anchor aria-hidden=true>#</a></h2><p>Traditional automated builds often have unrestricted internet access, which can lead to several challenges in enterprise environments:</p><ul><li>Limited control over downloaded artifacts</li><li>Potential unavailability of required resources</li><li>Security risks associated with write permissions to external repositories</li></ul><p>Best practice: Implement a two-step process:
a) Build: Create artifacts in a controlled environment, using local mirrors when possible.
b) Publish: Use a separate, secured process to distribute build results.</p><p>OCM supports this approach through filesystem-based OCM repositories, allowing you to generate Common Transport Format (CTF) archives for component versions.
These archives can then be securely processed and distributed.</p><h2 id=using-makefiles>Using Makefiles<a href=#using-makefiles class=anchor aria-hidden=true>#</a></h2><p>Developing applications and services using the Open Component Model usually is an iterative process
of building artifacts, generating OCM component versions and finally publishing them.
To simplify this process it should be automated and integrated into your build process.
One option is to use a <code>Makefile</code>.</p><p>The following example can be used as a starting point and can be modified according to your needs.
In this example we will use the same example as in the sections before:</p><ul><li>Creating a multi-arch image from Go sources from a Git repository using the Docker CLI</li><li>Packaging the Docker image and a Helm chart into a CTF archive</li><li>Signing and publishing the build result</li></ul><h3 id=prerequisites>Prerequisites<a href=#prerequisites class=anchor aria-hidden=true>#</a></h3><ul><li>The OCM CLI must be installed and be available in your PATH</li><li>The Makefile is located in the top-level folder of a Git project</li><li>Operating system is Unix/Linux</li><li>A sub-directory <code>local</code> can be used for local settings e.g. environment variables, RSA keys, &mldr;</li><li>A sub-directory <code>gen</code> will be used for generated artifacts from the <code>make build</code> command</li><li>It is recommended to add <code>local/</code> and <code>gen/</code> to the <code>.gitignore</code> file</li></ul><p>We use the following file system layout for the example:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ tree .
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── Dockerfile
</span></span><span class=line><span class=cl>├── LICENSE
</span></span><span class=line><span class=cl>├── Makefile
</span></span><span class=line><span class=cl>├── README.md
</span></span><span class=line><span class=cl>├── go.mod
</span></span><span class=line><span class=cl>├── helmchart
</span></span><span class=line><span class=cl>│   ├── Chart.yaml
</span></span><span class=line><span class=cl>│   ├── templates
</span></span><span class=line><span class=cl>│   │   ├── NOTES.txt
</span></span><span class=line><span class=cl>│   │   ├── _helpers.tpl
</span></span><span class=line><span class=cl>│   │   ├── deployment.yaml
</span></span><span class=line><span class=cl>│   │   ├── hpa.yaml
</span></span><span class=line><span class=cl>│   │   ├── ingress.yaml
</span></span><span class=line><span class=cl>│   │   ├── service.yaml
</span></span><span class=line><span class=cl>│   │   ├── serviceaccount.yaml
</span></span><span class=line><span class=cl>│   │   └── tests
</span></span><span class=line><span class=cl>│   │       └── test-connection.yaml
</span></span><span class=line><span class=cl>│   └── values.yaml
</span></span><span class=line><span class=cl>├── <span class=nb>local</span>
</span></span><span class=line><span class=cl>│   └── env.sh
</span></span><span class=line><span class=cl>├── main.go
</span></span><span class=line><span class=cl>├── resources.yaml
</span></span><span class=line><span class=cl>└── VERSION</span></span></code></pre></div></figure></div><h3 id=example-makefile>Example Makefile<a href=#example-makefile class=anchor aria-hidden=true>#</a></h3><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-Makefile data-lang=Makefile><span class=line><span class=cl><span class=nv>NAME</span>      <span class=o>?=</span> simpleserver
</span></span><span class=line><span class=cl><span class=nv>PROVIDER</span>  <span class=o>?=</span> acme.org
</span></span><span class=line><span class=cl><span class=nv>GITHUBORG</span> <span class=o>?=</span> acme
</span></span><span class=line><span class=cl><span class=nv>IMAGE</span>     <span class=o>=</span> ghcr.io/<span class=k>$(</span>GITHUBORG<span class=k>)</span>/demo/<span class=k>$(</span>NAME<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>COMPONENT</span> <span class=o>=</span> <span class=k>$(</span>PROVIDER<span class=k>)</span>/demo/<span class=k>$(</span>NAME<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>OCMREPO</span>   <span class=o>?=</span> ghcr.io/<span class=k>$(</span>GITHUBORG<span class=k>)</span>/ocm
</span></span><span class=line><span class=cl><span class=nv>MULTI</span>     <span class=o>?=</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=nv>PLATFORMS</span> <span class=o>?=</span> linux/amd64 linux/arm64
</span></span><span class=line><span class=cl><span class=nv>REPO_ROOT</span>           <span class=o>=</span> .
</span></span><span class=line><span class=cl><span class=nv>VERSION</span>             <span class=o>=</span> <span class=k>$(</span>shell git describe --tags --exact-match 2&gt;/dev/null<span class=o>||</span> <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$$</span><span class=s2>(cat </span><span class=k>$(</span>REPO_ROOT<span class=k>)</span><span class=s2>/VERSION)&#34;</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>COMMIT</span>              <span class=o>=</span> <span class=k>$(</span>shell git rev-parse HEAD<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>EFFECTIVE_VERSION</span>   <span class=o>=</span> <span class=k>$(</span>VERSION<span class=k>)</span>-<span class=k>$(</span>COMMIT<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>GIT_TREE_STATE</span>      <span class=o>:=</span> <span class=k>$(</span>shell <span class=o>[</span> -z <span class=s2>&#34;</span><span class=k>$(</span>git status --porcelain 2&gt;/dev/null<span class=k>)</span><span class=s2>&#34;</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> clean <span class=o>||</span> <span class=nb>echo</span> dirty<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>GEN</span> <span class=o>=</span> ./gen
</span></span><span class=line><span class=cl><span class=nv>OCM</span> <span class=o>=</span> ocm
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>CHART_SRCS</span><span class=o>=</span><span class=k>$(</span>shell find helmchart -type f<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>GO_SRCS</span><span class=o>=</span><span class=k>$(</span>shell find . -name <span class=se>\*</span>.go -type f<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>ifeq</span> <span class=err>(</span><span class=k>$(</span><span class=nv>MULTI</span><span class=k>)</span><span class=err>,true)</span>
</span></span><span class=line><span class=cl><span class=nv>FLAGSUF</span>     <span class=o>=</span> .multi
</span></span><span class=line><span class=cl><span class=err>endif</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>build</span>
</span></span><span class=line><span class=cl><span class=nf>build</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>build</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>version</span>
</span></span><span class=line><span class=cl><span class=nf>version</span><span class=o>:</span>
</span></span><span class=line><span class=cl>  @echo <span class=k>$(</span>VERSION<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>ca</span>
</span></span><span class=line><span class=cl><span class=nf>ca</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>ca</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>$(GEN)/ca</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/.<span class=n>exists</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>image</span>.<span class=k>$(</span><span class=nv>NAME</span><span class=k>)$(</span><span class=nv>FLAGSUF</span><span class=k>)</span> <span class=n>resources</span>.<span class=n>yaml</span> <span class=k>$(</span><span class=nv>CHART_SRCS</span><span class=k>)</span>
</span></span><span class=line><span class=cl>  <span class=k>$(</span>OCM<span class=k>)</span> create ca -f <span class=k>$(</span>COMPONENT<span class=k>)</span> <span class=s2>&#34;</span><span class=k>$(</span>VERSION<span class=k>)</span><span class=s2>&#34;</span> --provider <span class=k>$(</span>PROVIDER<span class=k>)</span> --file <span class=k>$(</span>GEN<span class=k>)</span>/ca
</span></span><span class=line><span class=cl>  <span class=k>$(</span>OCM<span class=k>)</span> add resources --templater spiff <span class=k>$(</span>GEN<span class=k>)</span>/ca <span class=nv>COMMIT</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>COMMIT<span class=k>)</span><span class=s2>&#34;</span> <span class=nv>VERSION</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>VERSION<span class=k>)</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=nv>IMAGE</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>IMAGE<span class=k>)</span><span class=s2>:</span><span class=k>$(</span>VERSION<span class=k>)</span><span class=s2>&#34;</span> <span class=nv>PLATFORMS</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>PLATFORMS<span class=k>)</span><span class=s2>&#34;</span> <span class=nv>MULTI</span><span class=o>=</span><span class=k>$(</span>MULTI<span class=k>)</span> resources.yaml
</span></span><span class=line><span class=cl>  @touch <span class=k>$(</span>GEN<span class=k>)</span>/ca
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>$(GEN)/build</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GO_SRCS</span><span class=k>)</span>
</span></span><span class=line><span class=cl>  go build .
</span></span><span class=line><span class=cl>  @touch <span class=k>$(</span>GEN<span class=k>)</span>/build
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>image</span>
</span></span><span class=line><span class=cl><span class=nf>image</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>image</span>.<span class=k>$(</span><span class=nv>NAME</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>$(GEN)/image.$(NAME)</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/.<span class=n>exists</span> <span class=n>Dockerfile</span> <span class=k>$(</span><span class=nv>OCMSRCS</span><span class=k>)</span>
</span></span><span class=line><span class=cl>  docker build -t <span class=k>$(</span>IMAGE<span class=k>)</span>:<span class=k>$(</span>VERSION<span class=k>)</span> --file Dockerfile <span class=k>$(</span>COMPONENT_ROOT<span class=k>)</span> .<span class=p>;</span>
</span></span><span class=line><span class=cl>  @touch <span class=k>$(</span>GEN<span class=k>)</span>/image.<span class=k>$(</span>NAME<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>multi</span>
</span></span><span class=line><span class=cl><span class=nf>multi</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>image</span>.<span class=k>$(</span><span class=nv>NAME</span><span class=k>)</span>.<span class=n>multi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>$(GEN)/image.$(NAME).multi</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/.<span class=n>exists</span> <span class=n>Dockerfile</span> <span class=k>$(</span><span class=nv>GO_SRCS</span><span class=k>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Building Multi </span><span class=k>$(</span>PLATFORMS<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> i in <span class=k>$(</span>PLATFORMS<span class=k>)</span><span class=p>;</span> <span class=k>do</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=nv>tag</span><span class=o>=</span><span class=nv>$$</span><span class=o>(</span><span class=nb>echo</span> <span class=nv>$$</span>i <span class=p>|</span> sed -e s:/:-:g<span class=o>)</span><span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=nb>echo</span> <span class=s2>&#34;Building platform </span><span class=nv>$$</span><span class=s2>i with tag: </span><span class=nv>$$</span><span class=s2>tag&#34;</span><span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  docker buildx build --load -t <span class=k>$(</span>IMAGE<span class=k>)</span>:<span class=k>$(</span>VERSION<span class=k>)</span>-<span class=nv>$$</span>tag --platform <span class=nv>$$</span>i .<span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=k>done</span>
</span></span><span class=line><span class=cl>  @touch <span class=k>$(</span>GEN<span class=k>)</span>/image.<span class=k>$(</span>NAME<span class=k>)</span>.multi
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>ctf</span>
</span></span><span class=line><span class=cl><span class=nf>ctf</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>ctf</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>$(GEN)/ctf</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>ca</span>
</span></span><span class=line><span class=cl>  @rm -rf <span class=k>$(</span>GEN<span class=k>)</span>/ctf
</span></span><span class=line><span class=cl>  <span class=k>$(</span>OCM<span class=k>)</span> transfer ca <span class=k>$(</span>GEN<span class=k>)</span>/ca <span class=k>$(</span>GEN<span class=k>)</span>/ctf
</span></span><span class=line><span class=cl>  touch <span class=k>$(</span>GEN<span class=k>)</span>/ctf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>push</span>
</span></span><span class=line><span class=cl><span class=nf>push</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>ctf</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>push</span>.<span class=k>$(</span><span class=nv>NAME</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>$(GEN)/push.$(NAME)</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>ctf</span>
</span></span><span class=line><span class=cl>  <span class=k>$(</span>OCM<span class=k>)</span> transfer ctf -f <span class=k>$(</span>GEN<span class=k>)</span>/ctf <span class=k>$(</span>OCMREPO<span class=k>)</span>
</span></span><span class=line><span class=cl>  @touch <span class=k>$(</span>GEN<span class=k>)</span>/push.<span class=k>$(</span>NAME<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>transport</span>
</span></span><span class=line><span class=cl><span class=nf>transport</span><span class=o>:</span>
</span></span><span class=line><span class=cl><span class=err>ifneq</span> <span class=err>(</span><span class=k>$(</span><span class=nv>TARGETREPO</span><span class=k>)</span><span class=err>,)</span>
</span></span><span class=line><span class=cl>  <span class=nf>$(OCM) transfer component -Vc  $(OCMREPO)//$(COMPONENT)</span><span class=o>:</span><span class=k>$(</span><span class=nv>VERSION</span><span class=k>)</span> <span class=k>$(</span><span class=nv>TARGETREPO</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=err>else</span>
</span></span><span class=line><span class=cl>  <span class=err>@echo</span> <span class=s2>&#34;Cannot transport no TARGETREPO defined as destination&#34;</span> <span class=err>&amp;&amp;</span> <span class=err>exit</span> <span class=err>1</span>
</span></span><span class=line><span class=cl><span class=err>endif</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>$(GEN)/.exists</span><span class=o>:</span>
</span></span><span class=line><span class=cl>  @mkdir -p <span class=k>$(</span>GEN<span class=k>)</span>
</span></span><span class=line><span class=cl>  @touch <span class=nv>$@</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>info</span>
</span></span><span class=line><span class=cl><span class=nf>info</span><span class=o>:</span>
</span></span><span class=line><span class=cl>  @echo <span class=s2>&#34;VERSION:  </span><span class=k>$(</span>VERSION<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  @echo <span class=s2>&#34;COMMIT:   </span><span class=k>$(</span>COMMIT<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  @echo <span class=s2>&#34;TREESTATE:   </span><span class=k>$(</span>GIT_TREE_STATE<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>describe</span>
</span></span><span class=line><span class=cl><span class=nf>describe</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>ctf</span>
</span></span><span class=line><span class=cl>  ocm get resources --lookup <span class=k>$(</span>OCMREPO<span class=k>)</span> -r -o treewide <span class=k>$(</span>GEN<span class=k>)</span>/ctf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>descriptor</span>
</span></span><span class=line><span class=cl><span class=nf>descriptor</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>ctf</span>
</span></span><span class=line><span class=cl>  ocm get component -S v3alpha1 -o yaml <span class=k>$(</span>GEN<span class=k>)</span>/ctf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>.PHONY</span><span class=o>:</span> <span class=n>clean</span>
</span></span><span class=line><span class=cl><span class=nf>clean</span><span class=o>:</span>
</span></span><span class=line><span class=cl>  rm -rf <span class=k>$(</span>GEN<span class=k>)</span>
</span></span></code></pre></div></figure></div><p>The Makefile supports the following targets:</p><ul><li><code>build</code> (default) simple Go build</li><li><code>version</code> show current VERSION of Github repository</li><li><code>image</code> build a local Docker image</li><li><code>multi</code> build multi-arch images with Docker&rsquo;s buildx command</li><li><code>ca</code> execute build and create a component archive</li><li><code>ctf</code> create a common transport format archive</li><li><code>push</code> push the common transport archive to an OCI registry</li><li><code>info</code> show variables used in Makefile (version, commit, etc.)</li><li><code>describe</code> display the component version in a tree-form</li><li><code>descriptor</code> show the component descriptor of the component version</li><li><code>transport</code> transport the component from the upload repository into another OCM repository</li><li><code>clean</code> delete all generated files (but does not delete Docker images)</li></ul><p>The variables assigned with <code>?=</code> at the beginning can be set from outside and override the default
declared in the Makefile. Use either an environment variable or an argument when calling <code>make</code>.</p><p>Example:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>PROVIDER</span><span class=o>=</span>foo make ca</span></span></code></pre></div></figure></div><h3 id=templating-the-resources>Templating the Resources<a href=#templating-the-resources class=anchor aria-hidden=true>#</a></h3><p>The Makefile uses a dynamic list of generated platforms for the images. You can just set the <code>PLATFORMS</code> variable:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-Makefile data-lang=Makefile><span class=line><span class=cl><span class=nv>MULTI</span>     <span class=o>?=</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=nv>PLATFORMS</span> <span class=o>?=</span> linux/amd64 linux/arm64
</span></span></code></pre></div></figure></div><p>If <code>MULTI</code> is set to <code>true</code>, the variable <code>PLATFORMS</code> will be evaluated to decide which image variants
will be built. This has to be reflected in the <code>resources.yaml</code>. It has to use the input type
<code>dockermulti</code> and list all the variants which should be packaged into a multi-arch image. This list
depends on the content of the Make variable.</p><p>The OCM CLI supports this by enabling templating mechanisms for the content by selecting a templater
using the option <code>--templater ...</code>. The example uses the
<a href=https://github.com/mandelsoft/spiff target=_blank rel=noopener>Spiff templater</a>.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-Makefile data-lang=Makefile><span class=line><span class=cl><span class=nf>$(GEN)/ca</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/.<span class=n>exists</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/<span class=n>image</span>.<span class=k>$(</span><span class=nv>NAME</span><span class=k>)$(</span><span class=nv>FLAGSUF</span><span class=k>)</span> <span class=n>resources</span>.<span class=n>yaml</span> <span class=k>$(</span><span class=nv>CHART_SRCS</span><span class=k>)</span>
</span></span><span class=line><span class=cl>  <span class=k>$(</span>OCM<span class=k>)</span> create ca -f <span class=k>$(</span>COMPONENT<span class=k>)</span> <span class=s2>&#34;</span><span class=k>$(</span>VERSION<span class=k>)</span><span class=s2>&#34;</span> --provider <span class=k>$(</span>PROVIDER<span class=k>)</span> --file <span class=k>$(</span>GEN<span class=k>)</span>/ca
</span></span><span class=line><span class=cl>  <span class=k>$(</span>OCM<span class=k>)</span> add resources --templater spiff <span class=k>$(</span>GEN<span class=k>)</span>/ca <span class=nv>COMMIT</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>COMMIT<span class=k>)</span><span class=s2>&#34;</span> <span class=nv>VERSION</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>VERSION<span class=k>)</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=nv>IMAGE</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>IMAGE<span class=k>)</span><span class=s2>:</span><span class=k>$(</span>VERSION<span class=k>)</span><span class=s2>&#34;</span> <span class=nv>PLATFORMS</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>PLATFORMS<span class=k>)</span><span class=s2>&#34;</span> <span class=nv>MULTI</span><span class=o>=</span><span class=k>$(</span>MULTI<span class=k>)</span> resources.yaml
</span></span><span class=line><span class=cl>  @touch <span class=k>$(</span>GEN<span class=k>)</span>/ca
</span></span></code></pre></div></figure></div><p>The variables given to the <code>add resources</code> command are passed to the templater. The template looks
like:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>image</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>ociImage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=l>(( values.VERSION ))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>input</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>(( bool(values.MULTI) ? &#34;dockermulti&#34; :&#34;docker&#34; ))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>repository</span><span class=p>:</span><span class=w>  </span><span class=l>(( index(values.IMAGE, &#34;:&#34;) &gt;= 0 ? substr(values.IMAGE,0,index(values.IMAGE,&#34;:&#34;)) :values.IMAGE ))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variants</span><span class=p>:</span><span class=w> </span><span class=l>(( bool(values.MULTI) ? map[split(&#34; &#34;, values.PLATFORMS)|v|-&gt; values.IMAGE &#34;-&#34; replace(v,&#34;/&#34;,&#34;-&#34;)] :~~ ))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>(( bool(values.MULTI) ? ~~ :values.IMAGE ))</span></span></span></code></pre></div></figure></div><p>By using a variable <code>values.MULTI</code>, the command distinguishes between a single Docker image and a multi-arch image.
With <code>map[]</code>, the platform list from the Makefile is mapped to a list of tags created by the
<code>docker buildx</code> command used in the Makefile. The value <code>~~</code> is used to undefine the yaml fields not
required for the selected case (the template can be used for multi- and single-arch builds).</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-Makefile data-lang=Makefile><span class=line><span class=cl><span class=nf>$(GEN)/image.$(NAME).multi</span><span class=o>:</span> <span class=k>$(</span><span class=nv>GEN</span><span class=k>)</span>/.<span class=n>exists</span> <span class=n>Dockerfile</span> <span class=k>$(</span><span class=nv>GO_SRCS</span><span class=k>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Building Multi </span><span class=k>$(</span>PLATFORMS<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> i in <span class=k>$(</span>PLATFORMS<span class=k>)</span><span class=p>;</span> <span class=k>do</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=nv>tag</span><span class=o>=</span><span class=nv>$$</span><span class=o>(</span><span class=nb>echo</span> <span class=nv>$$</span>i <span class=p>|</span> sed -e s:/:-:g<span class=o>)</span><span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=nb>echo</span> <span class=s2>&#34;Building platform </span><span class=nv>$$</span><span class=s2>i with tag: </span><span class=nv>$$</span><span class=s2>tag&#34;</span><span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  docker buildx build --load -t <span class=k>$(</span>IMAGE<span class=k>)</span>:<span class=k>$(</span>VERSION<span class=k>)</span>-<span class=nv>$$</span>tag --platform <span class=nv>$$</span>i .<span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=k>done</span>
</span></span><span class=line><span class=cl>  @touch <span class=k>$(</span>GEN<span class=k>)</span>/image.<span class=k>$(</span>NAME<span class=k>)</span>.multi
</span></span></code></pre></div></figure></div><h2 id=pipeline-integration>Pipeline Integration<a href=#pipeline-integration class=anchor aria-hidden=true>#</a></h2><p>Pipeline infrastructures are heterogeneous, so there is no universal answer how to
integrate a build pipeline with OCM. Usually, the simplest way is using the OCM command line interface.
Following you will find an example using GitHub actions.</p><p>There are two repositories dealing with GitHub actions:
The
<a href=https://github.com/open-component-model/ocm-action target=_blank rel=noopener>first one</a> provides various actions that can be
called from a workflow. The
<a href=https://github.com/open-component-model/ocm-setup-action target=_blank rel=noopener>second one</a>
provides the required installation of the OCM CLI into the container.</p><p>An typical workflow for a build step will create a component version and a transport archive:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>create-ocm</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>setup OCM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>open-component-model/ocm-setup-action@main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>create OCM component version</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>open-component-model/ocm-action@main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>create_component</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>component</span><span class=p>:</span><span class=w> </span><span class=l>acme.org/demo/simpleserver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class=l>${{ env.PROVIDER }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=l>github.com/jensh007</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>...</span></span></span></code></pre></div></figure></div><p>This creates a component version for the current build. Additionally, a CTF archive
can be created or the component version along with the built container images can be uploaded to an
OCI registry, etc.</p><p>More documentation is available
<a href=https://github.com/open-component-model/ocm-action target=_blank rel=noopener>here</a>. A full
example can be found in the sample Github repository.</p><h2 id=static-and-dynamic-variable-substitution>Static and Dynamic Variable Substitution<a href=#static-and-dynamic-variable-substitution class=anchor aria-hidden=true>#</a></h2><p>Looking at the
<a href=/docs/tutorials/build-deploy-applications-using-helm-charts-and-ocm/#building-the-common-transport-archive-ctf>settings file</a> shows that
some variables like the <code>version</code> or the <code>commit</code> change with every build
or release. In many cases, these variables will be auto-generated during the build.</p><p>Other variables like the version of 3rd-party components will just change from time to
time and are often set manually by an engineer or release manager. It is useful to separate
between static and dynamic variables. Static files can be checked-in into the source control system and
are maintained manually. Dynamic variables can be generated during the build.</p><h3 id=example-substitution-file>Example Substitution File<a href=#example-substitution-file class=anchor aria-hidden=true>#</a></h3><p>The following example shows how to separate static and dynamic variables.</p><p>Static settings, manually maintained:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>NAME</span><span class=p>:</span><span class=w> </span><span class=l>microblog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>COMPONENT_NAME_PREFIX</span><span class=p>:</span><span class=w> </span><span class=l>github.com/acme.org/microblog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>PROVIDER</span><span class=p>:</span><span class=w> </span><span class=l>ocm.software</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>ELASTIC_VERSION</span><span class=p>:</span><span class=w> </span><span class=m>8.5.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>MARIADB_VERSION</span><span class=p>:</span><span class=w> </span><span class=m>10.6.11</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>MARIADB_CHART_VERSION</span><span class=p>:</span><span class=w> </span><span class=m>11.4.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>NGINX_VERSION</span><span class=p>:</span><span class=w> </span><span class=m>1.5.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>NGINX_CHART_VERSION</span><span class=p>:</span><span class=w> </span><span class=m>4.4.2</span></span></span></code></pre></div></figure></div><p>auto-generated from a build script:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>VERSION</span><span class=p>:</span><span class=w> </span><span class=m>0.23.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>COMMIT</span><span class=p>:</span><span class=w> </span><span class=l>5f03021059c7dbe760ac820a014a8a84166ef8b4</span></span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ocm add componentversions --create --file ../gen/ctf --settings ../gen/dynamic_settings.yaml --settings static_settings.yaml component-constructor.yaml</span></span></code></pre></div></figure></div><h2 id=debugging-explain-the-blobs-directory>Debugging: Explain the Blobs Directory<a href=#debugging-explain-the-blobs-directory class=anchor aria-hidden=true>#</a></h2><p>For analyzing and debugging the content of a CTF archive, there are some supportive commands
to analyze what is contained in the archive and what is stored in which blob:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>tree ../gen/ctf
</span></span><span class=line><span class=cl>../gen/ctf
</span></span><span class=line><span class=cl>├── artifact-index.json
</span></span><span class=line><span class=cl>└── blobs
</span></span><span class=line><span class=cl>    ├── ...
</span></span><span class=line><span class=cl>    ├── sha256.59ff88331c53a2a94cdd98df58bc6952f056e4b2efc8120095fbc0a870eb0b67
</span></span><span class=line><span class=cl>    ├── ...</span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ocm get resources -r -o wide ../gen/ctf
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>REFERENCEPATH: github.com/acme.org/microblog/nginx-controller:1.5.1
</span></span><span class=line><span class=cl>NAME         : nginx-controller-chart
</span></span><span class=line><span class=cl>VERSION      : 1.5.1
</span></span><span class=line><span class=cl>IDENTITY     :
</span></span><span class=line><span class=cl>TYPE         : helmChart
</span></span><span class=line><span class=cl>RELATION     : <span class=nb>local</span>
</span></span><span class=line><span class=cl>ACCESSTYPE   : localBlob
</span></span><span class=line><span class=cl>ACCESSSPEC   : <span class=o>{</span><span class=s2>&#34;localReference&#34;</span>:<span class=s2>&#34;sha256:59ff88331c53a2a94cdd98df58bc6952f056e4b2efc8120095fbc0a870eb0b67&#34;</span>,<span class=s2>&#34;mediaType&#34;</span>:<span class=s2>&#34;application/vnd.oci.image.manifest.v1+tar+gzip&#34;</span>,<span class=s2>&#34;referenceName&#34;</span>:<span class=s2>&#34;github.com/acme.org/microblog/nginx-controller/ingress-nginx:4.4.2&#34;</span><span class=o>}</span>
</span></span><span class=line><span class=cl>...</span></span></code></pre></div></figure></div><h2 id=self-contained-transport-archives>Self-Contained Transport Archives<a href=#self-contained-transport-archives class=anchor aria-hidden=true>#</a></h2><p>The transport archive created from a component constructor file, using the command <code>ocm add componentversions --create ...</code>, does not automatically resolve image references to external OCI registries and stores them in the archive. If you want to create a self-contained transport archive with all images stored as local artifacts, you need to use the <code>--copy-resources</code> option in the <code>ocm transfer ctf</code> command. This will copy all external images to the blobs directory of the archive.</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ocm transfer ctf --copy-resources &lt;ctf-dir&gt; &lt;new-ctf-dir-or-oci-repo-url&gt;</span></span></code></pre></div></figure></div><p>Note that this archive can become huge, depending on the size of the external images !</p><h2 id=cicd-integration>CICD Integration<a href=#cicd-integration class=anchor aria-hidden=true>#</a></h2><p>Configure rarely changing variables in a static file and generate dynamic variables
during the build from the environment. See the
<a href=#static-and-dynamic-variable-substitution>Static and Dynamic Variable Substitution</a> section above.</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M5 12l6 6"/><path d="M5 12l6-6"/></svg></div><div class="d-flex flex-column"><div class=text-body-secondary>Prev</div><a href=/docs/reference/ocm-controller/architecture/ class="stretched-link text-reset text-decoration-none">Architecture</a></div></div></div><div class=m-2></div><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class=text-body-secondary>Next</div><a href=/docs/reference/ocm-controller/api/ocm-controller-api/ class="stretched-link text-reset text-decoration-none">OCM Controller API</a></div><div class="d-flex flex-column justify-content-center"><svg class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div></main></div></div></div></div><footer class="footer text-muted"><div class=container-fluid><div class="text-center text-lg-end"><small><div style="width:100vw;position:relative;left:50%;margin-left:-50vw;padding:0 1rem;box-sizing:border-box"><div style=display:flex;justify-content:center;align-items:center;flex-wrap:wrap;gap:2rem><small style=flex:1;text-align:center;min-width:200px>Building this site is powered by <a href=https://www.netlify.com/ target=_blank rel=noopener>Netlify</a></small><div style=flex:1;text-align:center;min-width:200px><img src=/images/next-generation-eu-funding.png alt="Funded by the European Union - NextGenerationEU" style=max-width:200px;width:100%;height:auto></div><small style=flex:1;text-align:center;min-width:200px>Copyright © Linux Foundation Europe.
Open Component Model is a project of NeoNephos Foundation.
For applicable policies including privacy policy,
terms of use and trademark usage guidelines,
please see <a href=https://linuxfoundation.eu/>https://linuxfoundation.eu</a>.
Linux is a registered trademark of Linus Torvalds.</small></div></div></small></div></div></footer><script async src=/js/app.c17553444ec7c62f781ddbaa011948f6d85a1bab49420047d68a2b89852a8b36.js integrity="sha256-wXVTRE7Hxi94HduqARlI9thaG6tJQgBH1ooriYUqizY="></script><script async src=/js/flexsearch.7b25ae2da7ab3cc745d4f8536e3f914f92ea8b1afad96ab9249c160c35e0648c.js integrity="sha256-eyWuLaerPMdF1PhTbj+RT5Lqixr62Wq5JJwWDDXgZIw="></script><script async src=/js/search-modal.0415aa45353ab123a509f6ddc6861549ece898b90872fcf757cd2663041dac96.js integrity="sha256-BBWqRTU6sSOlCfbdxoYVSezomLkIcvz3V80mYwQdrJY="></script></body></html>