{{ define "main" }}
  <div class="row flex-xl-nowrap">
    {{ if (in site.Params.doks.sectionNav .Section) -}}
      <div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block">
        {{ partial "sidebar/section-menu.html" . }}
      </div>
    {{ end -}}

    <main class="docs-content col-lg-11 col-xl-9 mx-xl-auto ocm-section-page">
      {{ if site.Params.doks.breadcrumbTrail -}}
        {{ partial "main/breadcrumb" . }}
      {{ end }}

      <h1>{{ .Title }}</h1>
      
      {{ with .Description }}
        <div class="section-desc-box">
          {{ . | safeHTML }}
        </div>
      {{ end }}

      {{ .Content }}

      {{ if not .Params.hideChildren }}
        {{/* Emoji â†’ SVG Icon Mapping (initial Vorschlag, abgeleitet aus content/ Frontmatter und assets/svg) */}}
        {{- $emojiMap := dict
          "ğŸ“š" "books"
          "ğŸ§­" "compass"
          "ğŸ" "device-desktop-code"
          "ğŸ”" "search"
          "âœ"  "shield-lock"
          "âœï¸" "shield-lock"
          "ğŸš€" "rocket"
          "ğŸ“¦" "package-import"
          "ğŸ“¥" "book-download"
          "ğŸ”©" "address-book"
          "ğŸ’»" "device-desktop-code"
          "ğŸ”‘" "key"
          "ğŸŒ" "world"
          "ğŸ› " "settings-heart"
          "ğŸ› ï¸" "settings-heart"
          "âš™"  "settings-bolt"
          "âš™ï¸" "settings-bolt"
          "âœ¨" "sparkles-2"
          "ğŸ’¡" "bulb"
          "ğŸ—‚" "library"
          "ğŸ“„" "clipboard-text"
          "ğŸ“" "library"
          "ğŸ¢" "go-game"
          "ğŸ’¾" "file-type-doc"
        -}}
        <div class="ocm-card-grid ocm-card-grid--vertical">
          {{ range .Pages }}
            {{- $raw := default "" .Params.icon -}}
            {{- $key := trim $raw " " -}}
            {{- $iconName := or (index $emojiMap $key) $key -}}
            {{- $res := (cond (ne $iconName "") (resources.Get (printf "svg/%s.svg" $iconName)) nil) -}}
            {{- /* Fallback: SVG Platzhalter statt Emoji */ -}}
            {{- if not $res -}}
              {{- $fallback := cond .IsSection "library" "book" -}}
              {{- $res = resources.Get (printf "svg/%s.svg" $fallback) -}}
            {{- end -}}
            <a class="ocm-card ocm-card--vertical" href="{{ .RelPermalink }}">
              <span class="ocm-card-icon" aria-hidden="true">
                {{- with $res -}}{{ .Content | safeHTML }}{{- end -}}
              </span>
              <div class="ocm-card-title">{{ .Title }}</div>
              {{ with .Description }}
                <div class="ocm-card-desc">{{ . }}</div>
              {{ end }}
            </a>
          {{ end }}
        </div>
      {{ end }}
    </main>
  </div>
{{ end }}
